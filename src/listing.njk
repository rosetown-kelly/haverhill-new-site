---
layout: layouts/base.njk
pagination:
  data: listings
  size: 1
  alias: listing
permalink: "/{{ listing.slug }}/"
eleventyComputed:
  title: "{{ listing.shortTitle }} – Haverhill"
  description: "{{ listing.address }} – {{ listing.status }}"
---

<div class="wrapper">
  <!-- Listing header -->
  <section class="listing-header">
    <h1>{{ listing.name }}</h1>
    <p class="address">{{ listing.address }}</p>
    <span class="status-large">{{ listing.status }}</span>
    <div class="price">{{ listing.leaseNote }}</div>
    <div class="price">Sale Price: {{ listing.salePrice }}</div>
  </section>

  <!-- Photo gallery -->
  <section class="gallery">
    <div class="gallery-main">

    {% for image in listing.galleryImages %}
        <img 
        src="{{ image }}"
        alt="{{ listing.name }} photo {{ loop.index }}"
        class="{% if loop.first %}active{% endif %}">
    {% endfor %}

    <button class="gallery-control left" type="button" aria-label="Previous photo">&lt;</button>
    <button class="gallery-control right" type="button" aria-label="Next photo">&gt;</button>

    </div>

    <div class="gallery-dots">
        {% for image in listing.galleryImages %}
            <button
            type="button"
            class="{% if loop.first %}active{% endif %}"
            aria-label="Photo {{ loop.index }}">
            </button>
        {% endfor %}
    </div>

  <!-- Info layout -->
  <div class="content-grid">
    <!-- Left column: description + highlights -->
    <div>
      <article class="section-card">
        <h2>Property Overview</h2>
        <p>
          {{ listing.overview | safe }}
        </p>
      </article>

    <article class="section-card">
    <h2>Highlights</h2>
    <ul class="highlights-list">
        {% for item in listing.highlights %}
        <li>{{ item }}</li>
        {% endfor %}
    </ul>
    </article>

      <article class="section-card">
        <h2>Additional Details</h2>
        <p>
         {{ listing.additionalDetails | safe }}
        </p>
      </article>
    </div>

    <!-- Right column: key facts + location -->
    <div>
      <aside class="section-card">
        <h2>Key Facts</h2>
        <ul class="key-facts-list">
          <li><span class="key-facts-label">Municipality:</span> {{ listing.address }}</li>
          <li><span class="key-facts-label">Property Type:</span> {{ listing.propertyType }}</li>
          <li><span class="key-facts-label">Available Area:</span> {{ listing.squareFootage }} ft</li>
          <li><span class="key-facts-label">Zoning:</span> {{ listing.type }}</li>
          <li><span class="key-facts-label">Occupancy:</span> {{ listing.occupancy }}</li>
          <li><span class="key-facts-label">Parking:</span> {{ listing.parking }}</li>
        </ul>
      </aside>

      <aside class="section-card">
        <h2>Location</h2>
        <p class="location-note">
          {{ listing.address }}
        </p>
        {{ listing.mapsEmbedUrl | safe }}
      </aside>

      <aside class="section-card">
        <h2>Contact</h2>
        <p>{{ listing.contact | safe }}</p>
      </aside>
    </div>
  </div>

  <div class="back-link-bottom">
    <a href="/">← Back to Home</a>
  </div>
</div>

<script>
  // Simple image carousel logic
  (function () {
    const images = document.querySelectorAll('.gallery-main img');
    const prevBtn = document.querySelector('.gallery-control.left');
    const nextBtn = document.querySelector('.gallery-control.right');
    const dots = document.querySelectorAll('.gallery-dots button');

    // If this page doesn't have a gallery, do nothing
    if (!images.length || !prevBtn || !nextBtn || !dots.length) {
      return;
    }

    let currentIndex = 0;

    function showImage(index) {
      if (!images.length) return;

      // Wrap index
      if (index < 0) index = images.length - 1;
      if (index >= images.length) index = 0;

      // Update images
      images.forEach((img, i) => {
        img.classList.toggle('active', i === index);
      });

      // Update dots
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });

      currentIndex = index;
    }

    prevBtn.addEventListener('click', () => {
      showImage(currentIndex - 1);
    });

    nextBtn.addEventListener('click', () => {
      showImage(currentIndex + 1);
    });

    dots.forEach((dot, i) => {
      dot.addEventListener('click', () => {
        showImage(i);
      });
    });
  })();
</script>
